(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[792],{47948:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/PostDetail/components/PostReactions",function(){return n(10767)}])},19279:function(e,t,n){"use strict";n.d(t,{fm:function(){return a},dd:function(){return i}}),n(85893);var a,r=n(67294);n(49113),n(76176),n(2370),n(91717),(a||(a={})).SIGN_IN="SIGN_IN";let o=r.createContext({states:[],closeModal:e=>{},openModal:(e,t)=>{}}),i=()=>(0,r.useContext)(o)},91717:function(e,t,n){"use strict";n.d(t,{E:function(){return p}}),n(85893);var a=n(2370),r=n(2418);let o=(0,a.v0)(r.Z);var i=n(67294);n(66739);var s=n(86650),c=n(47792);let u=(0,s.cF)(r.Z);class l{async uploadImageByUrl(e){let t=await new Promise((t,n)=>{let a=new Image;a.src=e.url,a.crossOrigin="anonymous",a.onload=function(){let e=document.createElement("canvas");e.width=a.width,e.height=a.height,e.getContext("2d").drawImage(a,0,0),e.toBlob(e=>{e?t(e):n(Error("Failed to convert image to blob"))})}}),n=await (0,s.KV)((0,s.iH)(this.storage,e.fileName||"".concat((0,c.k)(),".").concat(t.type)),t);return{result:n,url:await (0,s.Jt)(n.ref)}}constructor(e){this.storage=e}}new l(u);let d=i.createContext({auth:o,eagerSignInLoading:!0,user:null,signOut:()=>{}}),p=()=>(0,i.useContext)(d)},2418:function(e,t,n){"use strict";let a=(0,n(83977).ZF)({apiKey:"AIzaSyD63hodF2l2YG1qBYA3KrG_1lP6G34nHJY",authDomain:"duchuyhoangblog-5e5df.firebaseapp.com",databaseURL:"https://duchuyhoangblog-5e5df-default-rtdb.europe-west1.firebasedatabase.app",projectId:"duchuyhoangblog-5e5df",storageBucket:"duchuyhoangblog-5e5df.appspot.com",messagingSenderId:"1096120152389",appId:"1:1096120152389:web:a9dc5229dfdf01f9168e2c",measurementId:"G-B61M3RRE1T"});t.Z=a},45306:function(e,t,n){"use strict";var a=n(39828),r=n(2418);let o=(0,a.ad)(r.Z);t.Z=o},44620:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var a=n(39828),r=n(45306),o=n(47792);class i{async upsert(e,t){let n=(0,a.JU)(this.ref,e);return(await (0,a.QT)(n)).exists()?(0,a.r7)(n,t):this.create(t,{id:e})}async create(e,t){let{id:n,...r}=t||{};return(0,a.pl)((0,a.JU)(this.ref,n||(0,o.k)()),e,r)}async findById(e){let t=(0,a.JU)(this.ref,e);return(await (0,a.QT)(t)).data()}async getAll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[this.ref,...e];return(0,a.PL)(a.IO.apply(null,t))}async deleteByConditions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[this.ref,...e],n=await (0,a.PL)(a.IO.apply(null,t));await Promise.all(n.docs.map(async e=>{let t=(0,a.JU)(this.ref,e.id);await (0,a.oe)(t)}))}constructor(e,t){this.dbName=e,this.ref=t?(0,a.hJ)(r.Z,this.dbName).withConverter(t):(0,a.hJ)(r.Z,this.dbName)}}},66739:function(e,t,n){"use strict";n.d(t,{y:function(){return r}});var a=n(44620);let r="users";new a.Z(r,null)},10767:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return h}});var a,r,o=n(85893),i=n(49113),s=n(44620);(a=r||(r={})).LIKE="LIKE",a.HEART="HEART",a.SAD="SAD",a.ANGRY="ANGRY",a.HAPPY="HAPPY",a.COFFEE="COFFEE";let c=new s.Z("post-reactions",null);var u=n(98388);n(71788);var l=n(76176),d=n(91717),p=n(19279),f=n(67294),x=n(39828);let m=[{value:r.LIKE,Component:i.mN,className:"icon like-icon text-gray"},{value:r.HEART,Component:i.Xd,className:"icon heart-icon text-gray"},{value:r.HAPPY,Component:i.YJ,className:"icon happy-icon text-gray"},{value:r.COFFEE,Component:i.nY,className:"icon coffee-icon text-gray"},{value:r.SAD,Component:i._H,className:"icon sad-icon"},{value:r.ANGRY,Component:i.Gl,className:"icon angry-icon text-gray"}];var h=e=>{let{postId:t}=e,{user:n}=(0,d.E)(),{openModal:a}=(0,p.dd)(),[i,s]=(0,f.useState)(!1),[h,g]=(0,f.useState)({[r.LIKE]:[],[r.HEART]:[],[r.HAPPY]:[],[r.COFFEE]:[],[r.SAD]:[],[r.ANGRY]:[]});(0,f.useLayoutEffect)(()=>{(async()=>{let e=await c.getAll([(0,x.ar)("postId","==",t)]),n={[r.LIKE]:[],[r.HEART]:[],[r.HAPPY]:[],[r.COFFEE]:[],[r.SAD]:[],[r.ANGRY]:[]};e.docs.map(e=>{let t=e.data();n[t.type].push(t.user)}),g(n)})()},[t]);let y=async(e,r)=>{if(i)return;if(!n)return a(p.fm.SIGN_IN);let o={...h};s(!0),r?(await c.create({postId:t,type:e,user:null==n?void 0:n.uid}),o[e].push(n.uid)):(await c.deleteByConditions([(0,x.ar)("user","==",null==n?void 0:n.uid),(0,x.ar)("type","==",e)]),o[e]=o[e].filter(e=>e!==(null==n?void 0:n.uid))),s(!1),g(o)};return(0,o.jsx)("section",{className:"grid grid-cols-12 gap-4 mt-11",children:m.map((e,t)=>{let{value:a,Component:r,className:i}=e,s=h[a].includes(null==n?void 0:n.uid);return(0,o.jsxs)("div",{className:(0,u.m6)("border-[1px] border-transparent cursor-pointer reaction-item col-span-2 flex items-center justify-center h-[50px] box-border p-[5px_10px] bg-code-bg dark:bg-code-bg-dark rounded-[5px]",s&&"border-primary dark:border-dark-primary bg-code-bg-dark active",i),onClick:()=>{y(a,!s)},children:[(0,o.jsx)(r,{className:(0,u.m6)("size-6",i,s&&"active")}),(0,o.jsx)(l.Z,{className:(0,u.m6)("ml-2 font-semibold",i,s&&"active"),children:h[a].length})]},a)})})}},47792:function(e,t,n){"use strict";function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}n.d(t,{k:function(){return a}})},71788:function(){}},function(e){e.O(0,[2016,1890,8388,2915,2137,2888,9774,179],function(){return e(e.s=47948)}),_N_E=e.O()}]);